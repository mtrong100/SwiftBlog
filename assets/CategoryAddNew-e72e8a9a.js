import{u as w,e as A,r as N,Q as n,j as e,_ as P,d as D,p as E}from"./index-7b34d9b5.js";import{s as b}from"./slugify-94ae0324.js";import{R as l}from"./Radio-5bef7aad.js";import{c as O,a as R,u as S,F as u,L as m,I as V,b as C,o as F}from"./yup-a3725464.js";import{H}from"./Heading-477794ce.js";import{B as k}from"./Button-3187d7fe.js";import{u as h,c as a}from"./constants-c6ed1daf.js";const L=O({title:R().required("Please enter your title !")}),q=()=>{const{userInfo:t}=w(),{control:r,handleSubmit:g,watch:p,reset:x,formState:{isValid:f,isSubmitting:i,errors:d}}=S({mode:"onchange",resolver:F(L),defaultValues:{title:"",slug:"",status:"pending",createdAt:new Date}}),c=p("status"),j=A(),y=async o=>{if(f)try{const s={...o};s.slug=b(s.title,{lower:!0});const v=P(D,"categories");await E(v,{...s,createdAt:new Date}),j("/manage/category"),n.success("Add new category successfully !",{theme:"colored",autoClose:2e3,pauseOnHover:!1}),x({title:"",slug:"",status:"pending",createdAt:new Date})}catch{n.error("Failed to add new category !",{theme:"colored",autoClose:2e3,pauseOnHover:!1})}};return N.useEffect(()=>{var s;const o=Object.values(d);o.length>0&&n.error((s=o[0])==null?void 0:s.message,{theme:"colored",autoClose:2e3,pauseOnHover:!1})},[d]),e.jsxs("div",{children:[e.jsx(H,{children:"add new category"}),e.jsxs("form",{className:"pt-14",onSubmit:g(y),children:[e.jsxs("div",{className:"grid gap-10 mb-10 lg:grid-cols-2",children:[e.jsxs(u,{children:[e.jsx(m,{children:"Title ✒️"}),e.jsx(V,{control:r,placeholder:"Enter your title",name:"title"})]}),((t==null?void 0:t.role)===h.ADMIN||(t==null?void 0:t.role)===h.MOD)&&e.jsx(e.Fragment,{children:e.jsxs(u,{children:[e.jsx(m,{children:"Status"}),e.jsxs("div",{className:"flex items-center gap-x-5",children:[e.jsx(l,{name:"status",control:r,checked:c===a.APPROVED,value:a.APPROVED,children:"Approved"}),e.jsx(l,{name:"status",control:r,checked:c===a.PENDING,value:a.PENDING,children:"Pending"}),e.jsx(l,{name:"status",control:r,checked:c===a.UNAPPROVED,value:a.UNAPPROVED,children:"Unapproved"})]})]})})]}),e.jsx(k,{type:"submit",kind:"secondary",className:`w-[200px] mx-auto h-[65px]  ${i?"opacity-50 pointer-events-none":""}`,children:i?e.jsx(C,{}):"add new category"})]})]})};export{q as default};
