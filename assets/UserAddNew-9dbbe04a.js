import{u as I,r as R,Q as m,j as e,l as S,c as U,p as D,_ as O,d as k,G as F}from"./index-73878708.js";import{u as H,I as P}from"./ImageUpload-68379a1e.js";import{s as C}from"./slugify-5a8ede35.js";import{R as c}from"./Radio-fd09010a.js";import{c as L,a as t,u as M,F as l,L as o,I as d,b as V,o as q}from"./yup-cab4d3ba.js";import{H as $}from"./Heading-178aac5a.js";import{B}from"./Button-e76cae7b.js";import{u as a}from"./constants-c6ed1daf.js";import"./index.esm-5b8dc22c.js";const G=L({username:t().required("Please enter your username"),slug:t().lowercase(),email:t().lowercase().email("Please enter valid email").required("Please enter your email"),password:t().min(8,"Your password must be 8 characters or greater").required("Please enter your password")}),Z=()=>{I();const{control:r,handleSubmit:x,watch:g,setValue:j,getValues:f,reset:w,formState:{isValid:b,isSubmitting:u,errors:h}}=M({mode:"onchange",resolver:q(G),defaultValues:{email:"",password:"",username:"",avatar:"",slug:"",role:a.USER,createtAt:new Date}}),n=g("role"),{image:p,progress:y,handleSelectImage:E,handleDeleteImage:v,handleResetUpLoad:N}=H(j,f),A=async s=>{if(b)try{await S(U,s.email,s.password),await D(O(k,"users"),{username:s.username,email:s.email,password:s.password,slug:C(s.slug||s.username,{lower:!0}),role:s.role,avatar:p,createtAt:F()}),m.success("Add new user successfully !",{theme:"colored",autoClose:2e3,pauseOnHover:!1}),w({email:"",password:"",username:"",avatar:"",slug:"",role:a.USER,createtAt:new Date}),N()}catch{m.error("Failed to add new user !",{theme:"colored",autoClose:2e3,pauseOnHover:!1})}};return R.useEffect(()=>{var i;const s=Object.values(h);s.length>0&&m.error((i=s[0])==null?void 0:i.message,{theme:"colored",autoClose:2e3,pauseOnHover:!1})},[h]),e.jsxs("div",{children:[e.jsx($,{children:"add new user"}),e.jsxs("form",{className:"pt-14",onSubmit:x(A),children:[e.jsx("div",{className:"w-[300px] h-[300px] mx-auto rounded-full mb-16",children:e.jsx(P,{className:"!rounded-full h-full",onChange:E,handleDeleteImage:v,progress:y,image:p,userImage:"true"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-10 mb-10",children:[e.jsxs(l,{children:[e.jsx(o,{children:"username ✒️"}),e.jsx(d,{control:r,placeholder:"Enter your username",name:"username"})]}),e.jsxs(l,{children:[e.jsx(o,{children:"slug ✒️"}),e.jsx(d,{control:r,placeholder:"Example: taketa-hana",name:"slug"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 mb-10 gap-x-10",children:[e.jsxs(l,{children:[e.jsx(o,{children:"email ✒️"}),e.jsx(d,{control:r,placeholder:"Enter your email",name:"email"})]}),e.jsxs(l,{children:[e.jsx(o,{children:"password ✒️"}),e.jsx(d,{control:r,placeholder:"Enter your title",name:"password"})]})]}),e.jsx("div",{className:"grid grid-cols-2 mb-10 gap-x-10",children:e.jsxs(l,{children:[e.jsx(o,{children:"role"}),e.jsxs("div",{className:"flex items-center gap-x-5",children:[e.jsx(c,{name:"role",control:r,checked:n===a.ADMIN,value:a.ADMIN,children:"admin"}),e.jsx(c,{name:"role",control:r,checked:n===a.MOD,value:a.MOD,children:"mod"}),e.jsx(c,{name:"role",control:r,checked:n===a.USER,value:a.USER,children:"user"})]})]})}),e.jsx(B,{type:"submit",kind:"secondary",className:`w-[200px] mx-auto h-[65px]  ${u?"opacity-50 pointer-events-none":""}`,children:u?e.jsx(V,{}):"add new user"})]})]})};export{Z as default};
